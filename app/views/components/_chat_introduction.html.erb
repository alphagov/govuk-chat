<%
  early_access ||= false
  input_error_items ||= []
  input_value ||= nil
  title_text = early_access ? "Try GOV.UK Chat" : "GOV.UK Chat"
  form_url = Rails.application.routes.url_helpers.homepage_path
  start_button_href = Rails.application.routes.url_helpers.onboarding_limitations_path

  wrapper_classes = "app-c-chat-introduction"
  wrapper_classes += " app-c-chat-introduction--error" if input_error_items.any?
%>

<%= content_tag :div, class: wrapper_classes do %>
  <%= content_tag :div, class: "app-c-chat-introduction__svg-container" do %>
    <%= inline_svg_tag "components/chat_introduction/govuk-chat-chat-introduction-icon.svg", aria_hidden: true %>
  <% end %>

  <%= content_tag(:h1, title_text, class: "app-c-chat-introduction__title") %>
  <%= content_tag(:p, "An experimental new way to find answers to your business questions, powered by AI", class: "app-c-chat-introduction__lead-paragraph govuk-body") %>

  <% if early_access %>
    <% info_text = "By continuing, you consent to your email being used to provide access to the tool." %>

    <div class="govuk-!-width-two-thirds">
      <%= form_with url: form_url, class: "app-c-chat-introduction__form", authenticity_token: false do |f| %>
        <%= render "govuk_publishing_components/components/input", {
          label: {
            text: "Enter your email to sign up or get a new link for GOV.UK Chat",
          },
          name: "sign_in_or_up_form[email]",
          id: "sign_in_or_up_form_email",
          value: input_value,
          heading_level: 2,
          heading_size: "m",
          error_items: input_error_items,
          describedby: "info-text",
        } %>

        <%= render "components/blue_button", {
          text: "Get started",
          start: true,
        } %>
      <% end %>
    </div>
  <% else %>
    <% info_text = "Your chat history will be available for #{Rails.configuration.conversations.max_question_age_days} days" %>

    <%= render "components/blue_button", {
      text: "Try GOV.UK Chat",
      href: start_button_href,
      start: true,
      aria_describedby: "info-text",
      data_attributes: {
        "module": "ga4-link-tracker",
        "ga4-link": '{ "event_name": "navigation", "type": "start button", "index_link": 1, "index_total": 1, "section": "Landing page" }',
      },
    } %>
  <% end %>

  <div class="govuk-!-width-two-thirds">
    <%= content_tag(:p, info_text, {id: "info-text", class: "govuk-body govuk-!-margin-top-5"}) %>
  </div>
<% end %>
