<%
  data_attributes ||= {}

  maxlength ||= nil
  character_threshold ||= nil
  value ||= nil
  hint ||= nil
  hint_id ||= "hint-#{SecureRandom.hex(4)}"
  spellcheck ||= "true"

  error_items ||= []
  has_error ||= error_items.any?
  error_id ||= "error-#{SecureRandom.hex(4)}"

  describedby ||= nil
  aria_described_by ||= nil
  
  if hint || has_error || describedby
    aria_described_by = []
    aria_described_by << hint_id if hint
    aria_described_by << error_id if has_error
    aria_described_by << describedby if describedby
    aria_described_by = aria_described_by.join(" ")
  end
%>

<%= content_tag :div,
  class: "app-c-conversation-input",
  data: {
    maxlength: maxlength,
    character_threshold: character_threshold,
  }.merge(data_attributes) do %>

  <%= content_tag :div, class: "app-c-conversation-input__wrapper" do %>
    <%= label_tag(
      :create_question_user_question,
      label,
      class: "app-c-conversation-input__label govuk-visually-hidden",
    ) %>

    <%= text_field_tag(
      :create_question_user_question,
      "",
      class: "app-c-conversation-input__input",
      aria: {
        describedby: aria_described_by
      },
      name: name,
      value: value,
      maxlength: maxlength,
      required: true,
    ) %>

    <%= button_tag(
      "Send", 
      class: "app-c-conversation-input__submit",
    ) %>
  <% end %>

  <% if has_error %>
    <%= render "govuk_publishing_components/components/error_message", {
      id: error_id,
      items: error_items,
    } %>
  <% end %>

  <% if hint %>
    <%= render "govuk_publishing_components/components/hint", {
      id: hint_id,
      text: hint,
    } %>
  <% end %>
<% end %>
